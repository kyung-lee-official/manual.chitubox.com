import { Entry } from "@/docComponents/entry/Entry";
import { ImageGray } from "@/docComponents/imageGray/ImageGray";
import { AddMachineIcon } from "@/components/icons/ChituboxProIcons";

export const metadata = {
	title: "设置打印机参数",
	authors: [{ name: "CHITUBOX Team" }],
	description: "本节介绍了如何在 CHITUBOX 中添加、编辑和删除打印机。",
	other: {
		pageId: "/zh-CN/chitubox-pro/v2.0.0/printer-management",
	},
	openGraph: {
		images: ["/images/docs/og_logo.png"],
	},
};

# 打印机设置

一台打印机可以添加多个打印机配置，打印机配置由 “机器”，“树脂”，“打印”，“高级” 四个部分组成。

其中 “机器” 部分是通用的，作用于当前打印机的所有打印机配置，而 “树脂”，“打印”，“高级” 部分是独立的， 您可以单独设置。

<Entry machineTab={[<div>打印机菜单</div>, <div>删除机器</div>]} />

## 机器

### 机器名称

机器名称是您为打印机配置设置的名称，可以是任意字符。

### 机器类型

机器类型是您的打印机的型号，每一种机器类型对应固定的打印机分辨率，大小和切片格式，需要和您的打印机适配，不可修改。

### 镜像

打印机曝光图像的镜像模式，包括： Normal，LCD_mirror 和 DLP_normal。

CHITUBOX 内置的机型已经预设了匹配的镜像模式，您可以根据实际情况选择合适的镜像模式。

<Admonition type="note">
	少数打印机可能会因屏幕安装问题导致图像发生镜像，建议您在开始打印前先带上紫外线防护眼镜观察曝光图案，对于上拉式 LCD 打印机来说，如果曝光图案是镜像的，则打印出的模型就是正常（非镜像）的。如果曝光图案是非镜像的，您需要尝试其他选项直至找到正确的镜像模式。
</Admonition>

### 分辨率和大小

分辨率指的是打印机的 X、Y 方向的分辨率，单位是像素。大小指的是打印机的打印区域大小，单位是毫米。

### 构建区域偏移

## 树脂

**树脂类型** 和 **树脂名称** 可以自定义，用于区分不同的树脂。

填入 **树脂密度** 和 **树脂价格** 后， CHITUBOX 可以根据切片体积帮助您估算打印成本。

## 打印

### 参数解释

### 二段运动控制 (TSMC)

## 高级

### 光强 PWM

PWM 是 Pulse Width Modulation 的缩写，即脉宽调制，其原理是通过调整光源在单位时间内的占空比来控制光源的光强。

**光强 PWM** 和 **底层光强 PWM** 分别控制打印机普通层和底层的光强，您可以根据实际情况调整。

### 图片灰度

图片灰度控制的是切片图像曝光区域（不含支撑）的灰度， 范围是 0 到 255，数值越大越接近白色，数值越小越接近黑色。

对于 LCD 打印机来说，切片图像曝光区域越白，透光率越高。对于 DLP 打印机来说，切片图像曝光区域越白，光强越高。

<ImageGray />

### 抗锯齿

抗锯齿有两种模式： **灰度抗锯齿** 和 **等级抗锯齿**。

#### 灰度抗锯齿

灰度抗锯齿是通过对切片图像边缘进行灰度羽化处理来减少锯齿现象，适用于 LCD 打印机。

##### 灰度范围

灰度范围是灰度值 0 到 255 的一个可自定义区间，该区间限制了图像模糊对曝光范围边缘羽化时可使用的灰度值范围。

##### 图像模糊

图像模糊的范围是 2 到 8，数值越大，曝光区域的边缘羽化越明显。

#### 抗锯齿等级（遗留）

等级抗锯齿是通过对切片图像边缘进行多次短时曝光来减少锯齿现象，仅适用于支持 cbddlp 的早期打印机，不支持其他格式。

### 缩放补偿

缩放补偿原理上和缩放模型没有区别，它作用于当前的配置而不是某个模型，避免了切换不同打印机或配置时需要手动修改模型大小的麻烦。

缩放补偿使用百分比来表示先对于原始尺寸的缩放，默认值为 100%。百分比数值越大，模型越大。百分比数值越小，模型越小。

### 公差补偿

**公差补偿** 和 **底层公差补偿** 分别控制打印机普通层和底层的公差补偿，通常用于解决螺栓螺母，榫卯结构等工件的契合度。底层公差补偿通常被用于解决底层长时间曝光导致的 “大象腿” 问题。

公差补偿的原理是将每一层曝光图像标注出内径 (a) 和外径 (b)， 然后根据公差补偿值调整内径和外径的大小。

a 值为正数时，内孔空间缩小，a 值为负数时，内孔空间扩大。

b 值为正数时，周长扩大，b 值为负数时，周长缩小。

<Admonition type="note" title="注意">
	* 当禁用底层公差补偿时，普通层公差补偿将对整个模型生效。
	* 公差补偿的原理是对每一层曝光图进行内外径检测而非对 3D 模型进膨胀或缩水操作，因此要求您的模型切片图不能存在内外径突变的情况（在某一高度外径变为内径或内径变为外径）。例如一根竖直的管状结构中间有一个横向的孔，就会导致切片图在这个高度发生内径变外径的情况。
	* 底层公差补偿仅作用于底层，当过渡层和底层公差补偿同时启用时，打印结果可能不如预期。
	<div className="flex">
		<div className="flex-1 flex justify-center">
		<img
			src={
				"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-transition_layers.png"
			}
		/>
		</div>
		<div className="flex-1 flex justify-center">
		<img
			src={
				"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-tc.png"
			}
		/>
		</div>
		<div className="flex-1 flex justify-center">
		<img
			src={
				"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-tc_transition_layers.png"
			}
		/>
		</div>
	</div>
	<div className="flex text-gray-500 text-sm">
		<div className="flex-1 text-center">
			仅设置过渡层
		</div>
		<div className="flex-1 text-center">
			仅开启底部公差补偿
		</div>
		<div className="flex-1 text-center">
			同时启用过渡层与底层公差补偿
		</div>
	</div>
</Admonition>


### 层打印时间补偿

一些高分辨率打印机在加载数据时可能会有额外的延迟，这将导致打印时间预估不准确，您可以设置时间补偿来改善这个问题。

-   手动输入

    每层打印时间补偿：一个 2 位数，范围在 `-99.99` 到 `99.99` 之间，默认为 `0` 秒。
    当启用时，单层预计时间 = 曝光时间 + 等待时间 + 移动时间 + 每层打印时间补偿

-   自动生成

	<ImageContainer
		src={
			"/images/docs/zh-CN/chitubox-basic/2.x.x/009-configure-print-parameters-print-time-compensation.png"
		}
	/>

	$$\text{层打印时间补偿} = \frac{\text{实际打印时间} - \text{软件预测时间}}{\text{层数}}$$


### 蒙板

蒙版是为了改善屏幕上不同位置的光强不均匀的问题，其目的是通过调节屏幕不同区域的透光率从而提供一层修正层，使得原本不均匀的光源变得均匀。

_蒙版文件_： 你可以点击 `...` 图标来选择现一张自定义图片，或者点击齿轮图标以使用 CHITUBOX 内置的 <NextLink href="#91-蒙版生成器">蒙版生成器</NextLink> 来生成一张蒙版图片。 <br />

_灰度单位_：点击 <NextLink href="#灰度单位">此处</NextLink> 了解灰度单位。

#### 蒙版生成器

CHITUBOX 的模板生成器支持两种模式：**中心辐射** 和 **矩阵模式**。

##### 中心辐射

**中心辐射** 生成类似涟漪的图案，圈数由**等分数量**设置。圆圈半径呈等分数列递增，递增量由**等分半径**设置。

**灰度参数** 的范围为 `0` (黑) 到 `255` (白)。

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.1.png"
	}
/>

举个例子，如果 **等分数量** 设为 5，**等分半径**设为 3 毫米，则涟漪图案的半径为

$$ 5 \times 3 = 15 \text{mm}$$

下图为不同**等分半径**的对比图：

<div className="max-w-screen-sm">
	<ImageComparison
		img1Src={
			"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.equal_radius_1.png"
		}
		text1={"等分數量設為 5, 等分半徑設為 1mm"}
		img2Src={
			"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.equal_radius_3.png"
		}
		text2={"等分數量設為 5, 等分半徑設為 3mm"}
	/>
</div>

##### 矩阵模式

**矩阵模式** 生成一个矩阵形状的图。行和列分别由 `m` 和 `n` 分别设置。
**灰度参数** 的范围为 `0` (黑) 到 `255` (白)。

举个例子，下图为一个由不同灰度组成的 2 × 3 矩阵。

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.2.png"
	}
/>

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.2x3_matrix.png"
	}
	style={{ maxWidth: "350px" }}
/>

#### 灰度单位

**灰度单位** 的原理是在 X 轴方向上对指定数量像素的灰度取平均值并应用到对应的像素上。

举个例子：

假设打印平台的尺寸是 80mm × 120mm，屏幕的分辨率为 800px × 1200px。

下图为蒙版图，分辨率也是 800px × 1200px。其中所有的小方块的分辨率均为 50px × 50px。

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.3.png"
	}
	style={{ width: 400 }}
/>

如果将 **灰度单位** 设为 51px, 则处理后的图片将如下图所示：

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.4.png"
	}
	style={{ width: 400 }}
/>

灰度从左到右逐渐变灰，这是因为原图上的每 51 个像素灰度被平均了。
考虑第一行的情况。第一组 51 像素的灰度是 50 个黑像素和 1 个白像素的平均值，因此结果会比黑色略浅一点点，虽然这个改变几乎肉眼不可见。第二组 51 像素的灰度是 49 个白像素和 2 个黑像素的平均值，因此结果会比白色略暗一点点。第三组 51 像素的灰度是 48 个黑像素和 3 个白像素的平均值，依此类推，直到剩下的余数 35 个白像素。

$$\frac{800}{51} = 15$$，余数 35

这个部分则由它们自己取平均值，因此灰度没有变化。

