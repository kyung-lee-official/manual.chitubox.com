import { ColorTag } from "@/docComponents/colorTag/ColorTag";
import { LightOffDelayCalculator } from "@/docComponents/lightOffDelayCalculator/LightOffDelayCalculator";
import { BilibiliVideoContainer } from "@/components/videoContainer/BilibiliVideoContainer";
import { Collapse } from "@/components/collapse/Collapse";
import { Entry } from "@/docComponents/entry/Entry";
import { Tsmc } from "@/docComponents/tsmc/Tsmc";
import { GearIcon } from "@/components/icons/ChituboxProIcons";

export const metadata = {
	title: "Slice Settings",
	authors: [{ name: "CHITUBOX Team" }],
	description: "Set print parameters in CHITUBOX Pro.",
	other: {
		pageId: "/en-US/chitubox-pro/v2.0.0/slice-settings",
	},
	openGraph: {
		images: ["/images/docs/og_logo.png"],
	},
};

# Slice Settings

## Machines

| Parameters         | Description                                                                               |
| ------------ | ---------------------------------------------------------------------------------- |
| Name         | Name of the current printer                                                                   |
| Machine Type     | Make and model of the printer                                                                     |
| Mirror         | Choose the mode for mirroring images                                                                       |
| Resolution       | X: Number of pixels in the X direction <br /> Y: number of pixels in the Y direction                                 |
| Size         | Maximum printable size in the X direction <br /> Maximum printable size in the Y direction <br /> Maximum printable size in the Z direction |
| Lock Ratio     | Lock the ratio of sizes or resolutions between different axes                                               |
| Build Area Offset | Set the boundary of printable areas on the build platform                                                                 |

<Admonition type="note" title="Note">
	Click <SpanA href="https://www.chitubox.com/zh/article/support/howto/chitubox-free/slicing/44">📃here </SpanA>to learn more about <b>mirror</b>.

    **Build Area Offset** is designed for the case when there are bad points in the edge area of your printer's curing screen, or when parts of the edge are non-working areas. Build Area Offset is used to avoid those areas.
</Admonition>

## Resin

You can configure the basic properties for resin here, including name, type, color, density, price and more. CHITUBOX uses these data to calculate usage and cost of resin for printing.

## Print

Set your print parameters here.

<Admonition type="note" title="Note">
	Not all printers support **Resting Time** waiting mode. Read the <SpanA href="https://wkhvloo2kw.feishu.cn/docx/W9XedDtuqoHK2IxsicvccQthngf">📃full compatibility list </SpanA> here.
</Admonition>

|Parameter    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Layer Height            | Thickness of each layer printed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Bottom Layer Count           | Number of layers at the beginning of the print. The Bottom Exposure Time applies to the first number of layers set by this parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Exposure Time         | Exposure time of normal print layers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Bottom Exposure Time     | Set the exposure time of the bottom layers. increasing the exposure time of the bottom layers helps increase the bond strength between the printing model and the printing platform                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Transition Layer Count         | The number of transition layers between the print bottom layers and the normal print layers. when printing in transition layers, the exposure time will decrease with the increase of printing layers. Other printing settings in the transition layers are the same as normal layers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Transition Type	         | Set the transition type of the exposure time for the transition layers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Waiting Mode During Printing | <em>Resting Time: </em><ul><li>Rest Time Before Lift: A time interval between light-off and the build plate starts to lift. </li><li>Rest Time After Lift: A time interval between the build plate lifts to the Lifting Distance and starts to retract. </li><li>Rest Time After Retract: A time interval between the build plete retracts to the lowest point and light-on. </li></ul><em>Light off delay: </em><br />Light-off delay is the total time of build plate lifts up, wait, and retract. <ul><li>Light-off Delay: Light-off delay for normal layers, Actual machine light-off time = maximum (total time of Z-axis up and down movement, configured light-off delay) </li><li>Bottom Light-off Delay: Light-off delay for bottom layers, Actual machine light-off time = maximum (total time of Z-axis up and down movement, configured light-off delay) </li></ul> |
| Bottom Lift Distance     | The distance of the printing platform moves away from the printing surface each time during bottom layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Lifting Distance         | The distance of the printing platform moves away from the printing surface each time during normal layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Bottom Retract Distance     | The distance of retract, do not change unless you have sufficient reason during bottom layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Retract Distance         | The distance of retract, do not change unless you have sufficient reason during normal layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Bottom Lift Speed     | The speed of the printing platform moves away from the printing surface each time during bottom layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Lifting Speed         | The speed of the printing platform moves away from the printing surface each time during normal layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Bottom Retract Speed     | The speed of the printing platform moves to the printing surface each time during bottom layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Retract Speed         | The speed of the printing platform moves to the printing surface each time during normal layers printing process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

### Two-stage Motion Control TSMC

<Collapse title="Note for Anycubic Users">
	Please not if you come from Anycubic Photon Workshop:

    * Anycubic Photon Workshop has basic settings and advanced settings, which are not differentiated in CHITUBOX formats. CHITUBOX only displays basic settings for printers not compatible with advanced settings. And only advanced settings are displayed for printers supporting both. You can also enter the same speed for the two stages and make sure that the total lift distance meets requirements if you do not want to use TSMC on a printer supporting advanced settings.

    * The order in which TSMC parameters are displayed in the UI is different for Anycubic Photon Workshop, where [0] indicates the motion stage close to the screen and [1] indicates the motion stage further from the screen. However, the parameters are displayed following the motion pattern in CHITUBOX, which might be confusing at first.
</Collapse>

There are two groups of lift and retract parameters in print settings for setting up TSMC.

As the print platform lifts up with the model, the FEP film  at the bottom of the resin vat pulls on the layer that is just cured until the layer detaches from the film. The suction effect is stronger when the model has larger contact areas with the FEP film and when the platform lifts up at higher speeds. The suction effect may cause the model to deform or even pull the model down from the print platform. We suggest that you should keep the lift process slow until the model detaches from the film. The lift can be accelerated when suction effect is no longer a concern to improve print efficiency. And the retract process follows the same principle. 

You can get familiarized with TSMC by adjusting the settings below.

<Tsmc />

### Buffer Layer

<Collapse title={"This setting only applies to Creality printers"}>
	<Admonition type="note" title="Note">
		This setting currently only applies to some Creality printers with larger print platform, such as HALOT-MAGE S and HALOT-MAGE PRO.
	</Admonition>

    Setting buffer layers can help reduce the impacting force as the platform retracts into the resin vat and avoid resin spill. 

    | Parameters           | Description                     |
    | -------------- | ------------------------ |
    | Buffer Layer Height     | Height of the buffer layer           |
    | Buffer Layer Motor Speed | Motor speed as the platform goes through the buffer layer |
    | Buffer Layer Light-off Delay | Light-off delay for the buffer layer   |
</Collapse>

## Gcode

<Admonition type="warning" title="Warning">
	Do not change code here without sufficient understanding of Gcode.
</Admonition>

<Admonition type="note" title="Note">
	Only _.zip_ format and its derived formats (such as _.cws_) support Gcode editing.
</Admonition>

## Advanced

### Bottom Light PWM

Light PWM for bottom layers, from `0` to `255`, controls the power of the UV light source for bottom layers.

Click <SpanA href="https://baike.baidu.com/item/%E8%84%89%E5%86%B2%E5%AE%BD%E5%BA%A6%E8%B0%83%E5%88%B6">here</SpanA> to learn more information about PWM.

### Light PWM

Light PWM for normal layers, from `0` to `255`, controls the power of the UV light source.

### Image Gray

Image gray levels, similar to Light PWM, controls the light transmittance of the LCD screen instead of controlling the power of the UV light source.

### Anti-aliasing

Anti-aliasting softens the triangular sawtooth of image edge to achieve smoother surface effect. The continuity of edge exposure and the intensity of light transmission can be adjusted by adding or deleting pixel units with certain gray levels between adjacent triangular serrations to achieve smoother edge areas.

#### Gery Scale Level

This mode applies to the _.ctb_ format.

| Parameters         | Descriptions                                                                                                     |
| ------------ | -------------------------------------------------------------------------------------------------------- |
| Grey Scale Level     | Range:  `0` ~ `255`. `0` stands for black, `255` stands for white. It determines the gray range that is available for anti-aliasing.                        |
| Image Blur Pixel | Available values: `2` ~ `8`. It determines the number of pixels for edge transition, the higher level you select, the softer edge would be. Similar to the feather function in Photoshop.|

#### Anti-aliasing Level

This is a legacy model only applying to _.cbddlp_ format.

| Parameters       | Description                                                                                                                          |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------- |
| Anti-aliasing Level | Available values:: `2`、`4`、`8`. It determines the edge exposure time. The higher the level you select, the longer the exposure time will be, this will result in sharper edges, thereby decreasing the effect of anti-aliasing.|

-   _Anti-aliasing Level_: `2`, `4`, `8`, **applies to _.cbddlp_ format**. It determines the edge exposure time. The higher the level you select, the longer the exposure time will be, this will result in sharper edges, thereby decreasing the effect of anti-aliasing.。

-   _Enable Image Blur_: Enable/Disable image blur, **applies to _.ctb_ format**。

    -   _Image Blur_: `2` ~ `8`, determines the number of pixels for edge transition, the higher level you select, the softer edge would be. Similar to the feather function in Photoshop.
### Shrinkage Compensation

Shrinkage compensation of the model in X, Y, Z Shrinkage compensation of the model in X, Y, Z directions. The percentage represents the size compared to the original size. The default value is 100%. Setting appropriate shrinkage compensation value can help mitigate size errors caused by material shrinkage or heat expansion during printing.

The model body is larger with a larger percentage value.

The model body is smaller with a smaller percentage value.

### Tolerance Compensation

Inner and outer diameter compensation of normal printing layers. 

a When a is larger, the inner diameter is shorter, and the model body is larger.

a When a is smaller, the inner diameter is longer, and the model body is smaller.

b When b is positive (compensate for model shrinkage), the inner diameter is smaller and the model body is bigger.

b When b is negative (compensate for model expansion), the inner diameter is larger and the model body is smaller.

### Bottom Tolerance Compensation

Inner and outer diameter compensation of bottom printing layers, usually used to resolve the "elephant trunk" effect.

a When a is larger, the inner diameter is shorter, and the model body is larger.

a When a is smaller, the inner diameter is longer, and the model body is smaller.

b When b is positive (compensate for model shrinkage), the inner diameter is smaller and the model body is bigger.

b When b is negative (compensate for model expansion), the inner diameter is larger and the model body is smaller.

<Admonition type="note" title="Note">
	1. When the bottom layer tolerance compensation is disabled, the normal layer tolerance compensation will be effective for the whole model. 1.
	Bottom tolerace compensates only affects bottom layers. When transition layer compensation and bottom tolerance compensation are both enabled, the print result may be not be as good as expected.
	<div className="flex">
		<div className="flex-1 flex justify-center">
			<img
				src={
					"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-transition_layers.png"
				}
			/>
		</div>
		<div className="flex-1 flex justify-center">
			<img
				src={
					"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-tc.png"
				}
			/>
		</div>
		<div className="flex-1 flex justify-center">
			<img
				src={
					"/images/docs/en-US/chitubox-basic/2.x.x/009-configure-print-parameters-tc_transition_layers.png"
				}
			/>
		</div>
	</div>
	<div className="flex text-gray-500 text-sm">
		<div className="flex-1 text-center">Only set transition layer compensation</div>
		<div className="flex-1 text-center">Only enable bottom tolerance compensation</div>
		<div className="flex-1 text-center">Enable both transition layer compensation and bottom tolerance compensation</div>
	</div>
</Admonition>

### Print Time Compensation

Some high-resolution printers can have extra delays when loading data and will lead to inaccurate printing time estimation. You can set up a time compensation to improve the issue.

-   **Manual Input**

    Layer Print Time Compensation: a 2-digit number between `-99.99` and `99.99` with default set at `0` s.

    When enabled, the Estimated Time For A Single Layer = Exposure Time + Waiting Time + Movement Time + Layer Print Time Compensation

-   **Auto Generation**

    <ImageContainer
    	src={
    		"/images/docs/zh-CN/chitubox-pro/2.x.x/014-slice-settings-print-time-compensation.png"
    	}
    />

    $$\text{Layer Print Time Compensation} = \frac{\text{Actual Printing Time} - \text{Software Forcast Time}}{\text{Layer Count}}$$

<Admonition type="note" title="Note">
	Remember to click <b>Apply</b> after changing parameters for the settings to take effect.
</Admonition>

### Mask

Mask is designed to solve a common light source issue of uneven light strength at different spots of the screen. The issue is usually caused by improper light sources. The purpose of the mask is to provide a correction layer on the screen by adjusting the transmittance on different areas of the screen respectively, making the uneven light homogeneous.

_Mask File_: You can select an existing image by clicking the `...` icon, or click the gear icon to create a new one using CHITUBOX's built-in <GearIcon /> <NextLink href="#蒙版生成器">mask generator</NextLink>. <br />
_Grey Scale Unit_: click <NextLink href="#灰度单位">here</NextLink> to learn more about gray scale unit.

#### Mask Generator

##### Hub-and-Spoke

**Hub-and-Spoke** generate a ripple-like pattern. The number of circles is set by **Number of equal parts**. Radius of circles are arithmetic sequence with a delta set by **Equal radius**. 

The range of **Gray Parameter** is between `0` (black) to `255` (white)。

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/2.x.x/014-slice-settings-hub-and-spoke.png"
	}
/>

For example, if **Number of equal parts** is set to 5, **Equal radius** is set to 3mm, the radius of the ripple will be

$$ 5 \times 3 = 15 \text{mm}$$

Here is a comparison for different **Equal radius**:

<div className="max-w-screen-sm">
	<ImageComparison
		img1Src={
			"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.equal_radius_1.png"
		}
		text1={"Number of equal parts set to 5, Equal radius set to 1mm"}
		img2Src={
			"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.equal_radius_3.png"
		}
		text2={"Number of equal parts set to 5, Equal radius set to 3mm"}
	/>
</div>

##### Matrix Mode

**Matrix Mode** generates a matrix-like pattern. Rows and columns are set by `m` and `n` respectively.
The range of **Gray Parameter** is from `0` (black) to `255` (white)。

For example, here is a 2 × 3 matrix with different grayscales.

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/2.x.x/014-slice-settings-matrix-mode.png"
	}
/>

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.2x3_matrix.png"
	}
	style={{ maxWidth: "350px" }}
/>

#### Gray scale unit

**Gray scale** unit is used to average the grey value of specified number of pixels in X-axis direction, and apply averaged grayscale to pixels in corresponding position of the original image.

Example: 

Let's say the size of the build plate is 80mm × 120mm, the resolution of the screen is 800px × 1200px.

This is the mask picture, also with resolution of 800px × 1200px. All squares in the picture have the size of 50px × 50px.

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.3.png"
	}
	style={{ width: 400 }}
/>

If the **Gray scale** unit was set to 51px, the processed image will be like this:

<ImageContainer
	src={
		"/images/docs/zh-CN/chitubox-pro/1.x.x/004-setting-up-configure-printer-parameters004.4.png"
	}
	style={{ width: 400 }}
/>

The greyscale increases from left to right as a result of averaging out every 51 pixels. Take the first row as an example: The first 51 pixels include 50 black pixels and 1 white pixel. The resulting average value is a tint lighter than pure black, barely noticeable to the naked eyes. The second group of 51 pixels contains 49 white pixels and 2 black pixels, averaging out to a color slightly darker than white. The third group of 51 pixels will be masked to the average greyscale of 48 dark pixels and 3 white pixels and so on, until we reach the remaining 35 odd pixels.

$$\frac{800}{51} = 15$$, remainder 35

This remaining pixels' grey sclae will be the average of 35 pixels of the same shade. Therefore, the resulting grayscale doesn't change.
